# entry_score構成要素の相関分析結果

## 実行日時
2025年1月（推定）

## 重要な発見

### ⚠️ すべての構成要素が負の相関を示している

**期待方向**: 正（高いほど良い、順張り）
**実際の相関**: すべて負（高いほど将来リターンが低い）

| 構成要素 | 平均相関 | 期待方向 | 判定 |
|---------|---------|---------|------|
| rsi_20d | -0.0169 | 正（順張り） | 負の相関 |
| rsi_60d | -0.0296 | 正（順張り） | 負の相関 |
| rsi_90d | -0.0445 | 正（順張り） | 負の相関 |
| bb_z_20d | -0.0370 | 正（順張り） | 負の相関 |
| bb_z_60d | -0.0319 | 正（順張り） | 負の相関 |
| bb_z_90d | -0.0365 | 正（順張り） | 負の相関 |
| bb_score_20d | -0.0351 | 正 | ⚠️ 弱い（負） |
| bb_score_60d | -0.0319 | 正 | ⚠️ 弱い（負） |
| bb_score_90d | -0.0388 | 正 | ⚠️ 弱い（負） |
| rsi_score_20d | -0.0192 | 正 | ⚠️ 弱い（負） |
| rsi_score_60d | -0.0310 | 正 | ⚠️ 弱い（負） |
| rsi_score_90d | -0.0451 | 正 | ⚠️ 弱い（負） |
| period_score_20d | -0.0305 | 正 | ⚠️ 弱い（負） |
| period_score_60d | -0.0344 | 正 | ⚠️ 弱い（負） |
| period_score_90d | -0.0414 | 正 | ⚠️ 弱い（負） |
| **entry_score** | **-0.0289** | **正** | **⚠️ 弱い（負）** |

## 問題点

### 1. 順張り設計が逆効果になっている可能性

- **設計思想**: `entry_score`は順張り設計（RSIが高いほど、BB Z-scoreが高いほど高スコア）
- **実際の結果**: すべての構成要素が負の相関（高いほど将来リターンが低い）
- **解釈**: 順張りが効いていない、または逆張りの方が有効な可能性

### 2. 相関の絶対値が小さい

- すべての相関が0.05未満（統計的に有意ではない可能性）
- ただし、**すべてが負であることは重要**
- 符号が一貫して逆であることは、設計上の問題を示唆

### 3. 期間による違い

- **RSI**: 90日が最も負の相関が強い（-0.0445）
- **BB Z-score**: 20日が最も負の相関が強い（-0.0370）
- **期間スコア**: 90日が最も負の相関が強い（-0.0414）

## 考えられる原因

### 1. 市場環境の影響
- 2020-2021年の市場環境では順張りが効かなかった可能性
- 上昇相場の後半で「買われすぎ」銘柄が下落した可能性

### 2. パラメータの最適化問題
- 最適化されたパラメータが特定の市場環境に過適合している可能性
- 順張りの閾値（rsi_base, bb_z_base）が適切でない可能性

### 3. 設計思想の見直しが必要
- 順張りではなく逆張り（RSIが低いほど、BB Z-scoreが低いほど高スコア）の方が有効な可能性
- または、`entry_score`の重みを下げる、または使用しない検討

## 推奨される次のステップ

### 1. 分位分析（quantile analysis）の実行
```bash
python analyze_feature_quantiles.py
```
- 上位20% vs 下位20%のforward return差を確認
- 非線形関係を検出
- `entry_score`上位が負けているかを確認

### 2. 2022-2023期間限定の分析
```bash
python analyze_period_2022_2023.py
```
- rollで崩壊した期間での`entry_score`の有効性を確認
- 期間依存性（レジーム依存）を確認

### 3. 判定ロジックの改善
- 負の相関でも「弱い」ではなく「注意が必要（符号逆転の可能性）」と表示
- 期待方向と符号が一致しない場合の警告を強化

### 4. Walk-Forward Analysisでの対応
- `entry_score`の重みを下げる
- または、`entry_score`の符号を反転させる検討
- または、`entry_score`を使用しない検討

## 結論

1. **すべての構成要素が負の相関**: 順張り設計が逆効果になっている可能性が高い
2. **相関の絶対値は小さい**: 統計的に有意ではないが、符号が一貫して逆であることは重要
3. **設計思想の見直しが必要**: 順張りではなく逆張り、または`entry_score`の使用を再検討

## 次のアクション

1. ✅ `analyze_entry_score_components.py`を実行（完了）
2. ⏳ `analyze_feature_quantiles.py`を実行（推奨）
3. ⏳ `analyze_period_2022_2023.py`を実行（推奨）
4. ⏳ 判定ロジックの改善（推奨）













