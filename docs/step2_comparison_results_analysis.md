# Step 2: A-1比較結果の分析

## 実行概要

- **実行日**: 2026-01-10
- **期間**: 2020-01-01 ～ 2025-12-31
- **評価日**: 2025-12-31
- **満了窓のみで集計**: True（require_full_horizon=True）

---

## 1. 24Mを含める比較（全戦略の積集合）

### 評価期間数
- **共通rebalance_date集合**: 48期間（2020-01-31 ～ 2023-12-29）
- **理由**: 24Mホライズンが完走できる期間のみ

### 結果比較

| 戦略 | 年率リターン(%) | 年率超過(%) | 勝率(%) | 最小(総)(%) | P10(総)(%) | 最小(超過)(%) | P10(超過)(%) |
|------|----------------|------------|---------|------------|-----------|--------------|-------------|
| **レジーム切替** | **19.84** | **3.31** | **62.5** | 8.61 | 9.90 | -8.47 | -5.15 |
| 固定24M | 19.05 | 2.52 | 64.6 | 4.94 | 11.05 | -8.61 | -5.56 |
| 固定12M_momentum | 17.97 | 1.43 | 56.2 | 7.92 | 10.21 | -10.83 | -6.26 |
| 固定12M_reversal | 13.42 | -3.11 | 39.6 | 3.04 | 6.50 | -17.50 | -11.33 |

### レジーム切替戦略の内訳（params_id_summary）

| params_id | 使用回数 | 平均年率リターン(%) | 平均年率超過(%) |
|-----------|---------|-------------------|----------------|
| operational_24M | 24回 | 20.78 | 4.30 |
| 12M_momentum | 19回 | 19.62 | 3.06 |
| 12M_reversal | 5回 | 16.12 | -0.54 |

**レジーム分布の解釈:**
- operational_24Mが最も多く使用（24/48 = 50%）
- これはrangeレジームで24Mが選ばれていることを示唆
- 12M_reversalは5回のみ（約10%）

---

## 2. 12Mだけの比較（12M戦略同士の積集合）

### 評価期間数
- **固定12M_momentum**: 60期間（2020-01-31 ～ 2024-12-30）
- **固定12M_reversal**: 60期間
- **レジーム切替（12Mのみ）**: 55期間
  - **注意**: レジーム切替戦略のnum_periodsが55期間となっている
  - これは、可変ホライズン（24Mも含む）のため、一部のrebalance_dateが除外された可能性

### 結果比較

| 戦略 | 年率リターン(%) | 年率超過(%) | 勝率(%) | 最小(総)(%) | P10(総)(%) | 最小(超過)(%) | P10(超過)(%) |
|------|----------------|------------|---------|------------|-----------|--------------|-------------|
| **レジーム切替（12Mのみ）** | **19.45** | **3.21** | **61.8** | 8.61 | 10.20 | -8.47 | -4.86 |
| 固定12M_momentum | 18.06 | 1.33 | 55.0 | 7.92 | 10.50 | -10.83 | -6.01 |
| 固定12M_reversal | 12.67 | -4.05 | 35.0 | -0.95 | 5.34 | -19.05 | -11.99 |

### レジーム切替戦略の内訳（params_id_summary）

**注意**: 12Mだけの比較なのに、`operational_24M`が24回使用されている
- **12M_momentum**: 26回（47.3%）
- **operational_24M**: 24回（43.6%）← **問題？**
- **12M_reversal**: 5回（9.1%）

**問題点:**
- 「12Mだけの比較」なのに、レジーム切替戦略で24M（operational_24M）が使用されている
- これは、レジーム切替のロジックが可変ホライズン（24Mも含む）になっているため
- `comparison_type="12m_only"`の場合、レジーム切替戦略でも12Mのみを使用すべき

---

## 3. 主要な発見

### 3.1 レジーム切替の優位性

**24Mを含める比較:**
- レジーム切替: 年率超過3.31% > 固定24M: 2.52%
- 勝率: レジーム切替 62.5% vs 固定24M 64.6%（ほぼ同等）
- **レジーム切替が固定24Mを0.79%上回る**

**12Mだけの比較:**
- レジーム切替（12Mのみ）: 年率超過3.21% > 固定12M_momentum: 1.33%
- 勝率: レジーム切替 61.8% > 固定12M_momentum 55.0%
- **レジーム切替が固定12M_momentumを1.88%上回る**

### 3.2 固定12M_reversalの弱さ

- **年率超過が負**: -3.11%（24Mを含める比較）、-4.05%（12Mだけの比較）
- **勝率が低い**: 39.6%（24Mを含める比較）、35.0%（12Mだけの比較）
- **P10（超過）が非常に低い**: -11.33%（24Mを含める比較）、-11.99%（12Mだけの比較）

**結論**: 固定12M_reversalは、運用候補として適さない

### 3.3 レジーム切替での12M_reversalの使用頻度

**24Mを含める比較:**
- 12M_reversal: 5回（10.4%）
- operational_24M: 24回（50.0%）
- 12M_momentum: 19回（39.6%）

**12Mだけの比較:**
- 12M_reversal: 5回（9.1%）
- operational_24M: 24回（43.6%）← 12Mだけの比較なのに24Mが使用されている
- 12M_momentum: 26回（47.3%）

**解釈:**
- 12M_reversalは、レジーム切替戦略でもほとんど使用されていない（約10%）
- これは、downレジームが少ないか、downレジームでも12M_reversalが選ばれにくいことを示唆

### 3.4 rangeレジームでの24M使用

- operational_24Mが24回使用されている（24Mを含める比較では50%）
- これは、rangeレジームで24Mが選ばれていることを示唆
- しかし、ChatGPTの分析では「range→24Mがドラッグ」と指摘されていた

---

## 4. 問題点と改善案

### 4.1 「12Mだけの比較」での24M使用

**問題:**
- `comparison_type="12m_only"`の場合、レジーム切替戦略でも12Mのみを使用すべき
- しかし、実際には`operational_24M`が24回使用されている

**原因:**
- レジーム切替のロジックが可変ホライズン（24Mも含む）になっている
- `comparison_type="12m_only"`の場合、レジーム切替戦略でも12Mのみに制限する必要がある

**改善案:**
- `comparison_type="12m_only"`の場合、レジーム切替戦略でもrangeレジームで12M_momentumを使用するように修正
- または、レジーム切替戦略を除外して、固定12M_momentumと固定12M_reversalのみで比較

### 4.2 共通rebalance_date集合の確認

**24Mを含める比較:**
- 共通集合: 48期間（期待通り）

**12Mだけの比較:**
- 固定12M_momentum: 60期間
- 固定12M_reversal: 60期間
- レジーム切替（12Mのみ）: 55期間

**問題:**
- レジーム切替戦略のnum_periodsが55期間となっており、60期間と一致していない
- これは、可変ホライズン（24Mを含む）のため、一部のrebalance_dateが除外された可能性

**改善案:**
- `comparison_type="12m_only"`の場合、レジーム切替戦略でも12Mのみを使用し、60期間で比較できるようにする

---

## 5. 推奨事項

### 5.1 12M_reversalの扱い

**結論: 運用候補から除外すべき**

理由:
- 年率超過が負（-3.11% / -4.05%）
- 勝率が低い（39.6% / 35.0%）
- レジーム切替でもほとんど使用されていない（約10%）

### 5.2 レジーム切替の優位性

**結論: レジーム切替は有効**

- 24Mを含める比較: 固定24Mを0.79%上回る
- 12Mだけの比較: 固定12M_momentumを1.88%上回る
- 勝率も良好（62.5% / 61.8%）

### 5.3 rangeレジームの見直し

**現状:**
- rangeレジームで24M（operational_24M）が使用されている（50%）
- しかし、ChatGPTの分析では「range→24Mがドラッグ」と指摘

**次のステップ（Step 3）:**
- rangeレジームで12M_momentumを使用する
- rangeレジームで前回のparams_idを維持（ヒステリシス）
- rangeレジームで24Mのまま（現状）

この3つを試して、最適なレジーム切替ポリシーを決定する

---

## 6. 次のアクション

1. **「12Mだけの比較」の修正**
   - `comparison_type="12m_only"`の場合、レジーム切替戦略でも12Mのみを使用するように修正
   - 共通rebalance_date集合を60期間で統一

2. **Step 3: レジームポリシーの見直し**
   - rangeレジームで12M_momentumを使用
   - rangeレジームで前回のparams_idを維持（ヒステリシス）
   - rangeレジームで24Mのまま（現状）

3. **12M_reversalの削除検討**
   - 運用候補から除外
   - レジーム切替でも使用しない（downレジームでも12M_momentumを使用）

---

**作成日**: 2026-01-10  
**作成者**: AI Assistant  
**目的**: Step 2結果の分析と次のステップの決定